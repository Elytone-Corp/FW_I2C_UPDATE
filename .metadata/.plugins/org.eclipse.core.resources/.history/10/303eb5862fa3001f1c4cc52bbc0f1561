


/*Script - state_manager.h*/
// by:-  Ashutosh tiwari


#include "state_manager.h"
#include "bootloader.h"  // Ensure this is included
#include <stdio.h>

// Define the global variable current_state in this file
bootloader_state_t current_state = STATE_BOOT;  // Ensure bootloader.h is included

void StateManager_Init(void) {
    current_state = STATE_BOOT;
    printf("[State Manager] Initialized to STATE_BOOT.\n");
}

void StateManager_SetState(bootloader_state_t state) {
    if (state < BOOTLOADER_IDLE || state > BOOTLOADER_ERROR) {  // Valid state range
        printf("[State Manager] Invalid state transition attempted.\n");
        return;
    }

    printf("[State Manager] Transitioning to state: %d\n", state);
    current_state = state;
}

bootloader_state_t StateManager_GetState(void) {
    return current_state;
}

bool StateManager_IsInState(bootloader_state_t state) {
    return current_state == state;
}
