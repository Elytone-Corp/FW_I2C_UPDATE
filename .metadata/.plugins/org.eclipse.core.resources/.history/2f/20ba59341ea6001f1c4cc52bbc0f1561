


/*Script - state_manager.h*/
// by:-  Ashutosh tiwari


#include "state_manager.h"
#include "bootloader.h"  // For bootloader_state_t
#include "log_manager.h" // For logging

// Define the global variable current_state
bootloader_state_t current_state = BOOTLOADER_BOOT;  // Default to BOOTLOADER_BOOT

void StateManager_Init(void) {
    current_state = BOOTLOADER_BOOT;  // Set initial state
    LogManager_Log(LOG_LEVEL_INFO, "[State Manager] Initialized to BOOTLOADER_BOOT.");
}

void StateManager_SetState(bootloader_state_t state) {
    if (state < BOOTLOADER_IDLE || state > BOOTLOADER_ERROR) {  // Valid range check
        LogManager_Log(LOG_LEVEL_ERROR, "[State Manager] Invalid state transition attempted.");
        return;
    }

    LogManager_Log(LOG_LEVEL_INFO, "[State Manager] Transitioning to state: %d", state);
    current_state = state;
}

bootloader_state_t StateManager_GetState(void) {
    return current_state;
}

bool StateManager_IsInState(bootloader_state_t state) {
    return current_state == state;
}
